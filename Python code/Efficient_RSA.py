from Crypto.Util.number import *
from Crypto import Random
import Crypto
import time
import gmpy2
import sys

bits= 1024
msg="Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]Large-print (also large-type or large-font) refers to the formatting of a book or other text document in which the typeface (or font), and sometimes the medium, are considerably larger than usual, to accommodate people who have poor vision. Often public special-needs libraries will stock large-print versions of books, along with versions written in Braille.  The standard font size for large print is at least 18 points in size, but different sizes are made to suit different visual needs.[1]"
#print("Message = " + str(msg) + "\n\n")
start_key = time.time()
#p = Crypto.Util.number.getPrime(bits, randfunc=Crypto.Random.get_random_bytes)
p =  179527255883986189312370454583256338593009148521039016556393991794876031033684918857026604095163498007289709699865541376473302259865222240933627317246843512580472513205413143496297207422415629161514519024102597845194318443573060089236527271053292061267927855117953986431802873050144538729202386898443016950871
print("p = "+str(p)+"\n\n")

#q = Crypto.Util.number.getPrime(bits, randfunc=Crypto.Random.get_random_bytes)
q = 116568994255094452785941984694864003197976903002306696391867782066284075839324717309460113750947403547284268879511329435057524121475938405567769327244028564539814150488986123437632843926427446810662580236903702500449086733373280719828614051568008907411008987133259088311340437740822870672498306606649540870573
print("q = "+str(q)+"\n\n")

n = p*q
#print("n = "+str(n)+"\n\n")

PHI = (pow(p,2)-1) * (pow(p,2)-p) + (pow(q,2)-1) * (pow(q,2)-q)
#print("PHI = "+str(PHI)+"\n\n")

e = 65537

d = (gmpy2.invert(e, PHI))
end_key = time.time() 
#print("d = "+str(d)+"\n\n")
print("Key Generation in microseconds : " + str((end_key - start_key)*1000))
"""
start_enc = time.time()
cry = []
for i in msg:
    cr = pow(ord(i),e,n)
    cry.append(cr)
end_enc = time.time()
#print("cipher text: ",cry)
print("Encryption in microseconds : " + str((end_enc - start_enc)*1000))

start_dec = time.time()
pl=""
for i in cry:
    pn = pow(i,d,n)
    pl += chr(pn)
#print("plain text: ",pl)
end_dec = time.time()
print("Encryption in microseconds : " + str((end_dec - start_dec)*1000))
"""